---
title: "Scoped Certified Application installation and configuration guide"
f1.keywords:
- NOCSH
ms.author: pebaum
author: pebaum
manager: scotv
audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
ms.collection:
- M365-subscription-management
ms.custom: AdminSurgePortfolio
ROBOTS: NOINDEX, NOFOLLOW
search.appverid:
- MET150
description: ""
---

# ­­­Scoped Certified Application installation and configuration guide

[Overview]() 

[Application dependencies in ServiceNow environments]()

[Configuration instructions]()

[Who can set up the Microsoft 365 support integration?]()

[What features are available in Microsoft 365 support integration?]() 

[Set up Microsoft 365 support integration with ServiceNow Basic Authentication]() 

[Set up Microsoft 365 support integration with AAD OAuth Token]()

[Set up Microsoft 365 support integration for Insights only]() 

[Test the configuration]() 

[Troubleshooting]() 

## Overview

Microsoft 365 support integration enables you to integrate Microsoft 365 help, support, and service health with ServiceNow. You can research Microsoft known and reported issues, resolve incidents, and complete tasks by using Microsoft recommended solutions and, if necessary, escalate to Microsoft human- assisted support.

## Application dependencies in ServiceNow environments

Permissions required:

    - oauth\_entity

    - oauth\_entity\_profile

After Microsoft 365 support integration was installed, two Application Cross-Scope accesses were created. If they're not created successfully for any reason, create them manually.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image1.png" style="width:5.91228in;height:1.65648in" alt="Graphical user interface, application Description automatically generated" />

## Configuration instructions

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image2.PNG" style="width:5.71879in;height:3.09377in" alt="Diagram Description automatically generated" />

To set up Microsoft 365 support integration:

- Register applications in Microsoft Azure Active Directory (AAD) for authentication of both outbound and inbound API calls.

- Create ServiceNow entities with Microsoft AAD applications for both outbound and inbound data flow.

- Integrate ServiceNow instance with Microsoft Support through Microsoft 365 Admin Portal.

## Who can set up Microsoft 365 support integration?

- Someone with permissions to create AAD applications.

- A ServiceNow admin.

- A Helpdesk Admin or Service Request Admin in Microsoft 365 tenants.

## What features are available in Microsoft 365 support integration?

Before setting up any configuration for Microsoft 365 support integration, review your answers to these questions:

- Does your ServiceNow environment allow Basic Authentication (access with ServiceNow user credential) for inbound webservice calls?

- If you have multiple tenants, do you plan to use a single tenant integrated with your ServiceNow environment for Microsoft 365 support integration?

This table shows the features available to you depending on the answers to the questions above and the specific instructions for how to set up Microsoft 365 support integration. For a description of each feature, see [Microsoft 365 support integration](https://store.servicenow.com/sn_appstore_store.do#!/store/application/6d05c93f1b7784507ddd4227cc4bcb9f).

<table>
<thead>
<tr class="header">
<th>Question #1 Answer</th>
<th>Question #2 Answer</th>
<th>What features are available?</th>
<th>Configuration Steps</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AYes</td>
<td>Yes</td>
<td><ul>
<li><p>Service Health Incidents</p></li>
<li><p>Recommended Solutions</p></li>
<li><p>Microsoft service request</p></li>
</ul></td>
<td><a href="#setup-microsoft-365-support-integration-with-servicenow-basic-authentication">3.3 Setup Microsoft 365 support integration with ServiceNow Basic Authentication</a></td>
</tr>
<tr class="even">
<td>Yes</td>
<td>No</td>
<td><ul>
<li><p>Service Health Incidents</p></li>
<li><p>Recommended Solutions</p></li>
<li><p>Microsoft service request</p></li>
</ul></td>
<td></td>
</tr>
<tr class="odd">
<td>No</td>
<td>Yes</td>
<td><ul>
<li><p>Service Health Incidents</p></li>
<li><p>Recommended Solutions</p></li>
<li><p>Microsoft service request</p></li>
</ul></td>
<td><a href="#setup-microsoft-365-support-integration-with-aad-oauth-token">3.4 Setup Microsoft 365 support integration with AAD OAuth Token</a></td>
</tr>
<tr class="even">
<td>No</td>
<td>No</td>
<td><ul>
<li><p>Service Health Incidents</p></li>
<li><p>Recommended Solutions</p></li>
</ul></td>
<td><a href="#setup-microsoft-365-support-integration-for-insights-only">3.5 Setup Microsoft 365 support integration for Insights ONLY</a></td>
</tr>
</tbody>
</table>

## Set up Microsoft 365 support integration with ServiceNow Basic Authentication

### Prerequisites

Some prerequisites are necessary to set up the Microsoft 365 support integration.

1. \[The person who can create AAD applications\] Create AAD Application under your Microsoft 365 tenant.

    1. Log on [Azure Portal](https://portal.azure.com/) with Microsoft 365 tenant credentials.

    2. Go to the **App registrations** page and create a new application.

2. Select **Accounts in this organizational directory only ({TenantName} only – Single tenant**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image3.PNG" style="width:5.93754in;height:3.43753in" alt="Graphical user interface, text, application, email Description automatically generated" />

3. Add redirect URL: <https://&lt;your-servicenow-instance&gt;.service-now.com/oauth\_redirect.do>.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image4.PNG" style="width:5.89067in;height:3.45315in" alt="Graphical user interface, text, application, email Description automatically generated" />

4. Get the application Client ID and create App Secret.

<!-- -->

2. \[The person who is a ServiceNow admin\] Set up Outbound OAuth Provider in ServiceNow

    1. Go to **System OAuth** > **Application Registry**.

    2. If the scope is not set to **Global**, open **Settings** > **Developer** > **Applications** to switch to **Global**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image5.PNG" style="width:5.9115in;height:3.4844in" alt="Graphical user interface, text, application, chat or text message Description automatically generated" />

3. Create a new application with the values below by selecting “[Connect to a third party OAuth Provider](https://dev77417.service-now.com/wizard_view.do?sys_action=sysverb_wizard_ans&WIZARD:action=follow&wiz_referring_url=oauth_entity_list.do?sys_id=-1@99@sys_target=oauth_entity@99@sysparm_fixed_query=@99@sysparm_group_sort=@99@sysparm_parent=2c7cab53d7232100f20bc8170e61036b@99@sysparm_query=type%3dclient%5eORtype%3doauth_provider@99@sysparm_target=@99@sysparm_view=&wiz_collection_key=&wiz_collectionID=&wiz_collection=&wiz_collection_related_field=&wiz_view=&wiz_action=sysverb_new&sys_id=79ce2f53d7232100f20bc8170e610361&sysparm_query=type=client%5eORtype=oauth_provider&sysparm_target=&sys_target=oauth_entity)”.

    - Client ID: The Client ID of the application that was create in step \#1

    - Client Secret: The App Secret of the application that was created in step \#1

    - Default Grant type: Client Credentials

    - Token URL: <https://login.microsoftonline.com/{M365\_Tenant\_Name}/oauth2/token>

    - Redirect URL:

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image6.PNG" style="width:5.90629in;height:2.43231in" alt="Graphical user interface, application Description automatically generated" />

3. \[The person who is a ServiceNow admin\] set up Inbound OAuth Provider.

    1. Go to **System OAuth** > **Application Registry**.

    2. If the scope is not set to **Global**, open **Settings** > **Developer** > **Applications** to switch to **Global**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image5.PNG" style="width:5.9115in;height:3.4844in" alt="Graphical user interface, text, application, chat or text message Description automatically generated" />

3. Create a new application by selecting **Create an OAuth API endpoint for external clients**. Name the inbound OAuth provider and leave other fields at their defaults.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image7.PNG" style="width:5.9115in;height:2.33335in" alt="Graphical user interface, application Description automatically generated" />

4. \[The person who is a ServiceNow admin\] Create Integration Users.

You must specify an integration user. If you don’t have an existing integration user or if you want to create one specific for this integration, go to **Organization** > **Users** to create a new user.

If you're creating a new integration user, check **Web service access only**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image8.PNG" style="width:5.91671in;height:3.09898in" alt="Graphical user interface, website Description automatically generated" />

### \[Optional\] Whitelist the service’s Ips of Microsoft 365 support integration

If your company is limiting internet access with your own policies, enable network access for the service of Microsoft 365 support integration by whitelisting the IP addresses below for both inbound and outbound API access.

- 52.149.152.32

- 40.83.232.243

- 40.83.114.39

- 13.76.138.31

- 13.79.229.170

- 20.105.151.142

> [!NOTE]
> This terminal command lists all active IPs of the service for Microsoft 365 support integration:
> *nslookup connector.rave.microsoft.com*

### Set up Microsoft 365 support integration application

The Microsoft 365 support integration application can be set up under Microsoft 365 Support.

These steps are required to set up the integration between your ServiceNow instance and Microsoft Support.

1. **\[The person who is a ServiceNow admin\] Switch the scope to Microsoft 365 support integration.**

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image9.PNG" style="width:5.88546in;height:3.47919in" alt="Graphical user interface, table Description automatically generated" />

2. \[The person who is a ServiceNow admin\] Go to Microsoft 365 Support > **Setup** to open the integration flow.

> [!NOTE]
> If you see the error "Read operation against 'oauth\_entity' from scope 'x\_mioms\_m365\_assis' has been refused due to the table's cross-scope access policy," it was caused by your table access policy. You must make sure **All application scopes** > **Can read** is checked for the table oauth\_entity.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image10.PNG" style="width:5.92192in;height:2.20835in" alt="Graphical user interface, text, application, email Description automatically generated" />

3. **\[The person who is a ServiceNow admin\] Click “Agree” button to agree the consent**

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image11.PNG" style="width:5.88025in;height:1.39584in" alt="Graphical user interface, text, application, email Description automatically generated" />

4. **\[The person who is a ServiceNow admin\] Set up Outbound OAuth Provider**

Select the OAuth profile for Outbound OAuth Provider created in [Pre-requirement](#pre-requirement-1) step \#2 and select **Next**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image12.PNG" style="width:5.9115in;height:2.51044in" alt="Graphical user interface, text, application, email Description automatically generated" />

5. **\[The person who is a ServiceNow admin\] Set up Inbound OAuth Provider**

- Uncheck **Skip current step**

- Uncheck **External OIDC Auth Token**

- Select OAuth Client created in [Pre-requirement](#pre-requirement-1) step \#3 and select **Next**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image13.PNG" style="width:5.90629in;height:2.54689in" alt="Graphical user interface, text, application, email Description automatically generated" />

6. **\[The person who is a ServiceNow admin\] Set up Inbound Call Integration User**

- Uncheck **Skip current step**.

- Select the integration user created in [Pre-requirement](#pre-requirement-1) step \#4 and select **Next**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image14.PNG" style="width:5.86983in;height:2.0521in" alt="Graphical user interface, text, application Description automatically generated" />

7. **\[The person who is a ServiceNow admin\] Set up Repository ID.**

Specify the repository ID, and then select **Next**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image15.PNG" style="width:5.88546in;height:2.0521in" alt="Graphical user interface, text, application Description automatically generated" />

8. **\[The person who is a ServiceNow admin\] Set up Application Settings.**

Select the right settings, and then select **Next**.

- SSO with Microsoft 365: check if the ServiceNow instance is setup SSO with Microsoft 365 tenants otherwise uncheck it.

- Microsoft 365 Admin Email: the email of Microsoft 365 Admin user who will be contacted when Microsoft 365 support cases are created.

- Test Environment: check if it is for test phase to avoid Microsoft Support Agents contacting you to address the issue. If you are ready to move forward to use Microsoft 365 support integration officially, please uncheck it.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image16.PNG" style="width:5.88025in;height:2.15106in" alt="Graphical user interface, text, application Description automatically generated" />

9. **\[The person who is Helpdesk Admin or Service Request Admin in Microsoft 365 tenants\] Complete Integration.**

<!-- -->

1. Check the information below to ensure it's correct.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image17.PNG" style="width:5.91671in;height:2.38543in" alt="Graphical user interface, text, application Description automatically generated" />

2. Go to Microsoft 365 [Admin Portal](https://admin.microsoft.com) > **Settings** > **Settings** > **Organization profiles**.

3. Set up support integration settings.

<!-- -->

1. In the **Basic information** tab, select internal support tool **Service Now** and type **Outbound App ID** as the value of Application ID on the page Step - 6 Complete, which was created in [Pre-requirement](#pre-requirement-1) step \#1.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image18.PNG" style="width:5.9227in;height:3.46923in" alt="Graphical user interface, text, application, email Description automatically generated" />

2. In the tab **Repositories**, select **Add a repository** to create a new repository with the following settings:

- Repository: The value of “Repository ID” on the page “Step - 6 Complete the integration”

- Endpoint: The value of “Endpoint” on the page “Step - 6 Complete the integration”

- Authentication type: select “Basic Auth”.

- Client Id: The value of “Client ID” on the page “Step - 6 Complete the integration”.

- Client secret: The secret of the inbound OAuth provider that was created in [Pre-requirement](#pre-requirement-1) step \#3.

- Refresh token expiry: 864000

- Rest username: The value of “User Name” on the page “Step - 6 Complete the integration”.

- Rest user password: The password of the integration user that was created in [Pre-requirement](#pre-requirement-1) step \#4.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image19.PNG" style="width:5.92192in;height:3.49482in" alt="Graphical user interface, application Description automatically generated" />

3. Go back and click the button to save the integration.

<!-- -->

4. Select **Next** to complete the integration.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image20.PNG" style="width:5.90629in;height:2.72919in" alt="Graphical user interface, application, website Description automatically generated" />

10. **\[The person who is a ServiceNow admin\] Enable Microsoft 365 support integration for an existing user.**

Microsoft 365 support integration is enabled only for the user with one of these roles:

- [x\_mioms\_m365\_assis.insights\_user](https://ven01306.service-now.com/sys_user_role.do?sys_id=802b2adfdb4cac507c80230bd3961911&sysparm_record_target=sys_user_role&sysparm_record_row=2&sysparm_record_rows=2&sysparm_record_list=nameSTARTSWITHx_mioms_m365%5EORDERBYname)

- [x\_mioms\_m365\_assis.administrator](https://ven01306.service-now.com/sys_user_role.do?sys_id=4b25c9fb1b7784507ddd4227cc4bcb3a&sysparm_record_target=sys_user_role&sysparm_record_row=1&sysparm_record_rows=2&sysparm_record_list=nameSTARTSWITHx_mioms_m365%5EORDERBYname)

> [!NOTE]
> The user with the role x\_mioms\_m365\_assis.insights\_user role can see Service Health Incidents, Recommended Solutions. The user with the role x\_mioms\_m365\_assis.administrator can also open a case with Microsoft 365 Support.

11. **\[Optional\] \[The person who is a ServiceNow admin\] Link Microsoft 365 Admin account**

If any user has the role x\_mioms\_m365\_assis.administrator and is using different Microsoft 365 accounts to manage a Microsoft 365 Support case, they must go to Microsoft 365 Support > Link Account to set up their Microsoft 365 admin email.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image21.PNG" style="width:5.92192in;height:1.66668in" alt="Graphical user interface, text, application Description automatically generated" />

## Set up Microsoft 365 support integration with AAD OAuth Token

### Prerequisites

These prerequisite steps are necessary to set up the Microsoft 365 support integration:

1. \[The person who can create AAD applications\] Create AAD Application for Outbound under your Microsoft 365 tenant.

    1. Log on [Azure Portal](https://portal.azure.com/) with Microsoft 365 tenant credentials.

    2. Go to the **App registrations** page and create a new application.

2. Select **Accounts in this organizational directory only ({TenantName} only – Single tenant**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image3.PNG" style="width:5.93754in;height:3.43753in" alt="Graphical user interface, text, application, email Description automatically generated" />

3. Add redirect URL: <https://&lt;your-servicenow-instance&gt;.service-now.com/auth\_redirect.do>

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image4.PNG" style="width:5.89067in;height:3.45315in" alt="Graphical user interface, text, application, email Description automatically generated" />

4. Get Client ID of the application and create App Secret.

<!-- -->

2. \[The person who can create AAD applications\] Create AAD Application for Rest API under your Microsoft 365.

    1. Log on to the [Azure Portal](https://portal.azure.com/) with your Microsoft 365 tenant credentials.

    2. Go to **App registrations** and create a new application.

Select **Accounts in this organizational directory only ({TenantName} only – Single tenant**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image22.PNG" style="width:5.91671in;height:3.40628in" alt="Graphical user interface, text, application, email Description automatically generated" />

3. Get the application Client ID and create App Secret.

<!-- -->

3. \[The person who can create AAD applications\] Create AAD Application for Rest User under your Microsoft 365 tenant.

    1. Log on to the [Azure Portal](https://portal.azure.com/) with your Microsoft 365 tenant credentials.

    1. Go to the **App registrations** page and create a new application.
    1. Select **Accounts in this organizational directory only ({TenantName} only – Single tenant**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image23.PNG" style="width:5.9115in;height:3.41669in" alt="Graphical user interface, text, application, email Description automatically generated" />

3. Get the application Client ID and create App Secret.

<!-- -->

4. \[The person who is a ServiceNow admin\] Set up Outbound OAuth Provider in ServiceNow

<!-- -->

1. Go to **System OAuth** > **Application Registry**.

2. If the scope is not set to **Global**, open **Settings** > **Developer** > **Applications** to switch to **Global**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image5.PNG" style="width:5.9115in;height:3.4844in" alt="Graphical user interface, text, application, chat or text message Description automatically generated" />

3. Create a new application with the values below by selecting “[Connect to a third party OAuth Provider](https://dev77417.service-now.com/wizard_view.do?sys_action=sysverb_wizard_ans&WIZARD:action=follow&wiz_referring_url=oauth_entity_list.do?sys_id=-1@99@sys_target=oauth_entity@99@sysparm_fixed_query=@99@sysparm_group_sort=@99@sysparm_parent=2c7cab53d7232100f20bc8170e61036b@99@sysparm_query=type%3dclient%5eORtype%3doauth_provider@99@sysparm_target=@99@sysparm_view=&wiz_collection_key=&wiz_collectionID=&wiz_collection=&wiz_collection_related_field=&wiz_view=&wiz_action=sysverb_new&sys_id=79ce2f53d7232100f20bc8170e610361&sysparm_query=type=client%5eORtype=oauth_provider&sysparm_target=&sys_target=oauth_entity)”.

    - Client ID: The Client ID of the application that was created in [Pre-requirement](#pre-requirement-1) step \#1

    - Client Secret: The App Secret of the application that was created in [Pre-requirement](#pre-requirement-1) step \#1

    - Default Grant type: Client Credentials

    - Token URL: https://login.microsoftonline.com/{M365\_Tenan\_Name}/oauth2/token

    - Redirect URL:

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image6.PNG" style="width:5.90629in;height:2.43231in" alt="Graphical user interface, application Description automatically generated" />

5. \[The person who is a ServiceNow admin\] Configure OIDC provider in ServiceNow, refer to [online documentation](https://docs.servicenow.com/bundle/quebec-platform-administration/page/administer/security/task/add-OIDC-entity.html), otherwise go step 7.

<!-- -->

1. Go to **System OAuth** > **Application Registry**.

2. If the scope is not set to **Global**, open **Settings** > **Developer** > **Applications** to switch to **Global**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image5.PNG" style="width:5.9115in;height:3.4844in" alt="Graphical user interface, text, application, chat or text message Description automatically generated" />

3. Select **New** > **Create new Open ID Connect Provider**.

4. In **OAuth OIDC Provider Configuration**, select Search and create a new OIDC provider configuration under “oidc\_provider\_configuration.list” with these values:

- OIDC Provider: Contoso Azure

- OIDC Metadata URL: https://login.microsoftonline.com/{tenant\_name}/.well-known/openid-configuration

- UserClaim: appId

- User Field: User ID

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image24.PNG" style="width:5.92713in;height:2.36981in" alt="Graphical user interface, text, application Description automatically generated" />

5. Create a new application with the values below by selecting **Configure an OIDC provider to verify ID tokens**.

- Name: contoso\_application\_inbound\_api

- Client ID: The Client ID of the application that was created in [Pre-requirement](#pre-requirement-1) step \#2.

- Client Secret: The App Secret of the application that was created in [Pre-requirement](#pre-requirement-1) step \#2

- OAuth OIDC Provider Configuration: The OIDC provider created in the last step

- Redirect URL:  
    https://{service\_now\_instance}.service-now.com/oauth\_redirect.do

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image25.PNG" style="width:5.92713in;height:2.07814in" alt="Graphical user interface, application Description automatically generated" />

6. \[The person who is a ServiceNow admin\] Create Integration Users.

Navigate to **Organization** > **Users** to create a new user if there is no integration user. The value of **User ID** is the application Client ID created in step [Pre-requirement](#pre-requirement-1) \#3

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image26.PNG" style="width:5.92713in;height:3.06252in" alt="Graphical user interface, application Description automatically generated" />

### \[Optional\] Whitelist the service’s Ips of Microsoft 365 support integration

If your company is limiting internet access with your own policies, enable network access for the service of Microsoft 365 support integration by whitelisting these IP addresses for both inbound and outbound API access:

- 52.149.152.32

- 40.83.232.243

- 40.83.114.39

- 13.76.138.31

- 13.79.229.170

- 20.105.151.142

> [!NOTE]
> This terminal command lists all active IPs of the service for Microsoft 365 support integration.
> *nslookup connector.rave.microsoft.com*

### Set up Microsoft 365 support integration

The Microsoft 365 support integration application can be set up through the “Setup” menu under the Microsoft 365 Support menu.

The following steps are needed to set up the integration between your ServiceNow instance and Microsoft support.

1. **\[The person who is a ServiceNow admin\] Switch the scope to Microsoft 365 support integration.**

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image9.PNG" style="width:5.88546in;height:3.47919in" alt="Graphical user interface, table Description automatically generated" />

2. **\[The person who is a ServiceNow admin\] Navigate to “Microsoft 365 Support” -&gt; “Setup” to open the integration flow.**

> [!NOTE]
> If you see the error "Read operation against 'oauth\_entity' from scope 'x\_mioms\_m365\_assis' has been refused due to the table's cross-scope access policy," it was caused by your table access policy. You must make sure **All application scopes** > **Can read** is checked for the table oauth\_entity.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image27.PNG" style="width:5.91228in;height:2.20343in" alt="Graphical user interface, text, application, email Description automatically generated" />

3. **\[The person who is a ServiceNow admin\] Select **Agree** to agree to the consent.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image11.PNG" style="width:5.88025in;height:1.39584in" alt="Graphical user interface, text, application, email Description automatically generated" />

4. **\[The person who is a ServiceNow admin\] Set up Outbound OAuth Provider**

Select OAuth profile for Outbound OAuth Provider that was created at [Pre-requirement](#pre-requirement-1) step \#4 and click the button “Next”.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image12.PNG" style="width:5.9115in;height:2.51044in" alt="Graphical user interface, text, application, email Description automatically generated" />

5. **\[The person who is a ServiceNow admin\] Set up Inbound OAuth Provider**

- Uncheck **Skip current step**.

- Check **External OIDC Auth Token**.

- Select the OAuth Client created at [Pre-requirement](#pre-requirement-1) step 5, and then select **Next**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image28.PNG" style="width:5.90629in;height:2.58856in" alt="Graphical user interface, text, application Description automatically generated" />

6. **\[The person who is a ServiceNow admin\] Set up Inbound Call Integration User**

- Uncheck **Skip current step**.

- Input the Client ID of the application that was created at [Pre-requirement](#pre-requirement-1) step \#3 and click the button “Next”.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image29.PNG" style="width:5.91671in;height:2.08335in" alt="Graphical user interface, text, application, email Description automatically generated" />

7. **\[The person who is a ServiceNow admin\] Set up Repository ID.**

Specify the repository ID and select **Next**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image15.PNG" style="width:5.88546in;height:2.0521in" alt="Graphical user interface, text, application Description automatically generated" />

8. **\[The person who is a ServiceNow admin\] Set up Application Settings.**

Select the right settings and select **Next**.

- SSO with Microsoft 365: check if the ServiceNow instance is setup SSO with Microsoft 365 tenants; otherwise uncheck it.

- Microsoft 365 Admin Email: the email of Microsoft 365 Admin user who will be contacted when Microsoft 365 support cases were created.

- Test Environment: check if it is for test phase to avoid Microsoft Support Agents contacting you to address the issue. If you are ready to move forward use Microsoft 365 support integration officially, please uncheck it.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image16.PNG" style="width:5.88025in;height:2.15106in" alt="Graphical user interface, text, application Description automatically generated" />

9. **\[The person who is Helpdesk Admin or Service Request Admin in Microsoft 365 tenants\] Complete Integration.**

<!-- -->

1. Check the information below to ensure it is correct.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image30.PNG" style="width:5.92713in;height:2.27085in" alt="Graphical user interface, text, application, email Description automatically generated" />

2. Go to Microsoft 365 [Admin Portal](https://admin.microsoft.com) > **Settings** > **Settings** > **Organization profiles**.

3. Set up support integration settings.

<!-- -->

1. In the tab “basic information”, select “Service Now” as internal support tool and type Outbound App ID as the value of “Application ID” on the page “Step - 6 Complete”, which was created in [Pre-requirement](#pre-requirement-1) step \#1.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image18.PNG" style="width:5.9227in;height:3.46923in" alt="Graphical user interface, text, application, email Description automatically generated" />

2. In the tab “Repositories”, click the button “Add a repository” to create a new repository with the information below.

- Repository: The value of “Repository ID” on the page “Step - 6 Complete the integration”

- Endpoint: The value of “Endpoint” on the page “Step - 6 Complete the integration”

- Authentication type: select “AAD Auth”.

- Client Id: The value of “Client ID” on the page “Step - 6 Complete the integration”, which is Client ID of the application that was created in [Pre-requirement](#pre-requirement-1) step \#2.

- Rest username: The value of “User Name” on the page “Step - 6 Complete the integration” which is Client ID of the application that was created in [Pre-requirement](#pre-requirement-1) step \#3.

- Rest user password: The App Secret of the application that was created in [Pre-requirement](#pre-requirement-1) step \#3.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image31.PNG" style="width:5.92791in;height:3.47444in" alt="Graphical user interface, application Description automatically generated" />

3. Go back and click the button to save the integration.

<!-- -->

4. Select **Next** to complete the integration.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image32.PNG" style="width:5.9115in;height:2.78648in" alt="Graphical user interface, application Description automatically generated" />

10. **\[The person who is a ServiceNow admin\] Enable Microsoft 365 support integration for an existing user.**

Microsoft 365 support integration is enabled only for users with the following roles:

- [x\_mioms\_m365\_assis.insights\_user](https://ven01306.service-now.com/sys_user_role.do?sys_id=802b2adfdb4cac507c80230bd3961911&sysparm_record_target=sys_user_role&sysparm_record_row=2&sysparm_record_rows=2&sysparm_record_list=nameSTARTSWITHx_mioms_m365%5EORDERBYname)

- [x\_mioms\_m365\_assis.administrator](https://ven01306.service-now.com/sys_user_role.do?sys_id=4b25c9fb1b7784507ddd4227cc4bcb3a&sysparm_record_target=sys_user_role&sysparm_record_row=1&sysparm_record_rows=2&sysparm_record_list=nameSTARTSWITHx_mioms_m365%5EORDERBYname)

> [!NOTE]
> The user with the role x\_mioms\_m365\_assis.insights\_user can see Service Health Incidents, Recommended Solutions. The user with the role x\_mioms\_m365\_assis.administrator also can open a case with Microsoft 365 Support.

11. **\[Optional\] \[The person who is a ServiceNow admin\] Link Microsoft 365 Admin account**

If any user has the role “x\_mioms\_m365\_assis.administrator” and they're using different Microsoft 365 accounts to manage Microsoft Support cases, they must go to Microsoft 365 Support > Link Account to set up their Microsoft 365 admin email.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image21.PNG" style="width:5.92192in;height:1.66668in" alt="Graphical user interface, text, application Description automatically generated" />

## Set up Microsoft 365 support integration for Insights only

### Prerequisites

These prerequisite steps are necessary to set up the Microsoft 365 support integration:

1. \[The person who can create AAD applications\] Create AAD Application under your Microsoft 365 tenant.

    1. Logon [Azure Portal](https://portal.azure.com/) with Microsoft 365 Tenant credential

    1. Go to the **App registrations** page and create a new application.

    1. Select **Accounts in this organizational directory only ({TenantName} only – Single tenant**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image3.PNG" style="width:5.93754in;height:3.43753in" alt="Graphical user interface, text, application, email Description automatically generated" />

3. Add redirect URL: <https://&lt;your-servicenow-instance&gt;.service-now.com/auth\_redirect.do>

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image4.PNG" style="width:5.89067in;height:3.45315in" alt="Graphical user interface, text, application, email Description automatically generated" />

4. Get Client ID of the application and create App Secret..

<!-- -->

2. \[The person who is a ServiceNow admin\] Set up Outbound OAuth Provider in ServiceNow

<!-- -->

1. Go to **System OAuth** > **Application Registry**.

2. If the scope is not set to **Global**, open **Settings** > **Developer** > **Applications** to switch to **Global**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image5.PNG" style="width:5.9115in;height:3.4844in" alt="Graphical user interface, text, application, chat or text message Description automatically generated" />

4. Create a new application with the values below by selecting “[Connect to a third party OAuth Provider](https://dev77417.service-now.com/wizard_view.do?sys_action=sysverb_wizard_ans&WIZARD:action=follow&wiz_referring_url=oauth_entity_list.do?sys_id=-1@99@sys_target=oauth_entity@99@sysparm_fixed_query=@99@sysparm_group_sort=@99@sysparm_parent=2c7cab53d7232100f20bc8170e61036b@99@sysparm_query=type%3dclient%5eORtype%3doauth_provider@99@sysparm_target=@99@sysparm_view=&wiz_collection_key=&wiz_collectionID=&wiz_collection=&wiz_collection_related_field=&wiz_view=&wiz_action=sysverb_new&sys_id=79ce2f53d7232100f20bc8170e610361&sysparm_query=type=client%5eORtype=oauth_provider&sysparm_target=&sys_target=oauth_entity)”.

- Client ID: The Client ID of the application that was created in [Pre-requirement](#pre-requirement-2) step \#1

- Client Secret: The App Secret of the application that was created in [Pre-requirement](#pre-requirement-2) step \#1

- Default Grant type: Client Credentials

- Token URL: <https://login.microsoftonline.com/{M365\_Tenan\_Name}/oauth2/token>

- Redirect URL: <https://{ServiceNow\_Istance\_Name}.service-now.com/oauth\_redirect.do>

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image6.PNG" style="width:5.90629in;height:2.43231in" alt="Graphical user interface, application Description automatically generated" />

### Set up Microsoft 365 support integration

The Microsoft 365 support integration application can be set up through **Setup** under Microsoft 365 Support.

The following steps are needed to set up the integration between your ServiceNow instance and Microsoft support.

1. **\[The person who is a ServiceNow admin\] Switch the scope to Microsoft 365 support integration.**

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image9.PNG" style="width:5.88546in;height:3.47919in" alt="Graphical user interface, table Description automatically generated" />

2. **\[The person who is a ServiceNow admin\] Navigate “Microsoft 365 Support” -&gt; “Setup” to open the integration flow.**

> [!NOTE]
> If you see the error "Read operation against 'oauth\_entity' from scope 'x\_mioms\_m365\_assis' has been refused due to the table's cross-scope access policy," it was caused by your table access policy. You must make sure **All application scopes** > **Can read** is checked for the table oauth\_entity.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image27.PNG" style="width:5.91228in;height:2.20343in" alt="Graphical user interface, text, application, email Description automatically generated" />

3. **\[The person who is a ServiceNow admin\] Click “Agree” button to agree the consent**

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image11.PNG" style="width:5.88025in;height:1.39584in" alt="Graphical user interface, text, application, email Description automatically generated" />

4. **\[The person who is a ServiceNow admin\] Set up Outbound OAuth Provider**

Select OAuth profile for Outbound OAuth Provider and click the button “Next”.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image12.PNG" style="width:5.9115in;height:2.51044in" alt="Graphical user interface, text, application, email Description automatically generated" />

5. **\[The person who is a ServiceNow admin\] Skip Inbound OAuth Provider**

Check “Skip current step” and click “Next” button

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image33.PNG" style="width:5.91228in;height:2.26073in" alt="Graphical user interface, text, application, email Description automatically generated" />

6. **\[The person who is a ServiceNow admin\] Skip Integration User**

Check **Skip current step** and select **Next**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image34.PNG" style="width:5.91228in;height:1.90131in" alt="Graphical user interface, text, application Description automatically generated" />

7. **\[The person who is a ServiceNow admin\] Set up Repository ID.**

Specify the repository ID and select **Next**.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image15.PNG" style="width:5.88546in;height:2.0521in" alt="Graphical user interface, text, application Description automatically generated" />

8. **\[The person who is a ServiceNow admin\] Set up Application Settings.**

Select the right settings and select **Next**.

- SSO with Microsoft 365: check if the ServiceNow instance is setup SSO with Microsoft 365 tenants; otherwise uncheck it.

- Microsoft 365 Admin Email: the email of Microsoft 365 Admin user who will be contacted when Microsoft 365 support cases were created.

- Test Environment: check if it is for test phase to avoid Microsoft Support Agents contacting you to address the issue. If you are ready to move forward use Microsoft 365 support integration officially, please uncheck it.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image16.PNG" style="width:5.88025in;height:2.15106in" alt="Graphical user interface, text, application Description automatically generated" />

9. **\[The person who is Helpdesk Admin or Service Request Admin in Microsoft 365 tenants\] Complete Integration.**

    1. Check the information below to ensure it is correct.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image35.PNG" style="width:5.91228in;height:2.27115in" alt="Graphical user interface, text, application, email Description automatically generated" />

2. Go to Microsoft 365 [Admin Portal](https://admin.microsoft.com) > **Settings** > **Settings** > **Organization profiles**.

3. Set up support integration settings with the information shown in setup flow.

<!-- -->

1. In the tab “basic information”, select “Service Now” as Internal support tool and type Outbound App ID as Application ID to issue OAuth token

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image18.PNG" style="width:5.9227in;height:3.46923in" alt="Graphical user interface, text, application, email Description automatically generated" />

2. In the tab “Repositories”, click the button “Add a repository” to create a new repository with the information below.

- Repository: The value of “Repository ID” on the page “Step - 6 Complete the integration”

- Endpoint: The value of “Endpoint” on the page “Step - 6 Complete the integration”

- Authentication type: select “AAD Auth”.

- Client Id: some random value, such “ignored”.

- Rest username: some random value, such “ignored”.

- Rest user password: some random value, such “ignored”.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image36.PNG" style="width:5.91228in;height:3.49007in" alt="Graphical user interface, application Description automatically generated" />

3. Go back and select the button to save the integration.

    1. Select Next to complete the integration.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image37.PNG" style="width:5.91228in;height:2.54202in" alt="Graphical user interface, application Description automatically generated" />

10. **\[The person who is a ServiceNow admin\] Enable Microsoft 365 support integration for an existing user.**

Microsoft 365 support integration is enabled only for these user roles:

- [x\_mioms\_m365\_assis.insights\_user](https://ven01306.service-now.com/sys_user_role.do?sys_id=802b2adfdb4cac507c80230bd3961911&sysparm_record_target=sys_user_role&sysparm_record_row=2&sysparm_record_rows=2&sysparm_record_list=nameSTARTSWITHx_mioms_m365%5EORDERBYname)

- [x\_mioms\_m365\_assis.administrator](https://ven01306.service-now.com/sys_user_role.do?sys_id=4b25c9fb1b7784507ddd4227cc4bcb3a&sysparm_record_target=sys_user_role&sysparm_record_row=1&sysparm_record_rows=2&sysparm_record_list=nameSTARTSWITHx_mioms_m365%5EORDERBYname)

> [!NOTE] 
> The user with the role x\_mioms\_m365\_assis.insights\_user can see Service Health Incidents, Recommended Solutions. The user with the role x\_mioms\_m365\_assis.administrator also can open a case with Microsoft 365 support.

11. **\[Optional\] \[The person who is a ServiceNow admin\] Link Microsoft 365 Admin account**

If any user has the role “x\_mioms\_m365\_assis.administrator and is using different Microsoft 365 accounts to manage a Microsoft support case, they must go to Microsoft 365 Support > Link Account to set up their Microsoft 365 admin email.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image21.PNG" style="width:5.92192in;height:1.66668in" alt="Graphical user interface, text, application Description automatically generated" />

## Test the configuration

If your application requires successful communication with external systems, outline how to test the connection to ensure a successful configuration.

Here are the steps to test the configuration of Microsoft 365 support integration:

1. Log on to ServiceNow portal as admin.

2. Open any incident.

3. Focus on Microsoft 365 Support tab, select Microsoft 365 Insights to determine if the recommended solutions were retrieved successfully.

<img src="C:\Git\microsoft-365-docs-pr\microsoft-365\admin\misc\media\image38.PNG" style="width:5.91228in;height:1.85443in" alt="Graphical user interface, application, website Description automatically generated" />

##  Troubleshooting

<table>
<thead>
<tr class="header">
<th>#</th>
<th>Problems</th>
<th>Diagnostics Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Can't see "Microsoft 365 Support" tab</td>
<td>Verify the current view and “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="even">
<td>2</td>
<td>Click the button for Microsoft recommended solutions but get error "Please contact your ServiceNow admin and ask them to complete the setup steps for the app."</td>
<td>Check the error message on top of the form<br />
and “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Click the button for Microsoft recommended solutions but get error "Please contact your ServiceNow admin and ask them to complete the final set up step for the app."</td>
<td>Check the error message on top of the form<br />
and “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="even">
<td>4</td>
<td>Type problem in search box and click the button for Microsoft recommended solutions but get error "Please contact your ServiceNow admin and ask them to complete the setup steps for the app."</td>
<td>Check the error message on top of the form<br />
and “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Type problem in search box and click the button for Microsoft recommended solutions but get error "Please contact your ServiceNow admin and ask them to complete the final set up step for the app."</td>
<td>Check the error message on top of the form<br />
and “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="even">
<td>6</td>
<td>Click the button "Contact Microsoft Support", but get the error "Please contact your ServiceNow admin and ask them to complete the setup steps for the app."</td>
<td>Check the error message on top of the form<br />
and “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Click the button "Contact Microsoft Support", but get the error "Please contact your ServiceNow admin and ask them to complete the final set up step for the app."</td>
<td>Check the error message on top of the form<br />
and “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="even">
<td>8</td>
<td>Click the button "Contact Microsoft Support” but get the error "{EmailAddress} is not a valid Microsoft 365 admin account. You need Microsoft 365 admin privileges to open a service request. In the app, link the admin account."</td>
<td>Check the error message on top of the form<br />
and “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Click the button for Microsoft recommended solutions but nothing shows up</td>
<td>Check “System Logs” – “Outbound HTTP logs” with filter login.microsoftonline.com and connector.rave.microsoft.com</td>
</tr>
<tr class="even">
<td>10</td>
<td>Click the button for Microsoft recommended solutions but get error "Please contact app support."</td>
<td>Check the error message on top of the form<br />
and “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="odd">
<td>11</td>
<td>Type problem in search box and click the button for Microsoft recommended solutions but nothing shows up</td>
<td>Check “System Logs” – “Outbound HTTP logs” with filter login.microsoftonline.com and connector.rave.microsoft.com</td>
</tr>
<tr class="even">
<td>12</td>
<td>Type problem in search box and click the button for Microsoft recommended solutions but get error "Please contact app support."</td>
<td>Check the error message on top of the form<br />
and “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="odd">
<td>13</td>
<td>User click the button "Contact Microsoft Support", but nothing happened</td>
<td>Check “System Logs” – “Outbound HTTP logs” with filter login.microsoftonline.com and connector.rave.microsoft.com</td>
</tr>
<tr class="even">
<td>14</td>
<td>Can’t see Microsoft recommended solution after reopening the incident</td>
<td>Check “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="odd">
<td>15</td>
<td>Can’t see Microsoft cases when reopening the incident that was transferred to Microsoft Support</td>
<td>Check “System Logs” -&gt; “All” with filter x_mioms_m365_assit</td>
</tr>
<tr class="even">
<td>16</td>
<td>Can't save ticket details, get error "Unable to save ticket details. Please contact App Support."</td>
<td>Check the error message on top of form</td>
</tr>
</tbody>
</table>
