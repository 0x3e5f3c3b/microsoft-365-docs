---
title: Migrating from a 3rd party HIPS to ASR rules
description: This topic describes how to approach a migration from a 3rd party Host Intrusion Prevention System (HIPS) solution into ASR rules.
keywords: Attack surface reduction rules, asr, asr rules, hips, host intrusion prevention system, protection rules, anti-exploit, antiexploit, exploit, infection prevention, Microsoft Defender for Endpoint, Microsoft Defender ATP
search.product: eADQiWindows 10XVcnh
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
ms.pagetype: security
ms.localizationpriority: medium
audience: ITPro
author: lovina-saldanha
ms.author: v-lsaldanha
manager: dansimp
ms.custom: asr
ms.technology: mde
---

# Migrating from a 3rd party HIPS to ASR rules

With the aim of helping customers understand how they can establish an effective mapping between possible rules that they are using today, and how those translate into the Microsoft Defender ATP, below is a table with the most common questions or scenarios from customers, when migrating from a 3rd party HIPS product over to ASR rules. 
|||||||
|:--|:--|:--|:--|:--|:--|
|Scope and Action|Processes|Operation|Examples of Files/Folders, Registry Keys/Values, Processes, Services|Attack Surface Reduction rules|Additional recommended features|
|All Processes: Block creation of specific files and registry keys||File Creation|*.zepto, *.odin, *.locky, *.jaff, *.lukitus, *.wnry, *.krab|The way ASR rules work are by blocking the attack techniques, and not the Indicators of Compromise (IOC) that are not durable and effective. Blocking a specific file extension, for example, is not often helpful, since it would not prevent a device from being compromised. It will only partially thwarts an  attack, until the malicious actor creates a new type of extension for the payload.|Having Microsoft Defender AV enabled, along with Cloud Protection and Behavior Analysis is highly recommended. It is also recommended to have additional preventative layers, such as the ASR rule "Use advanced protection against ransomware", to provide a greater level of protection against ransomware attacks. Furthermore, several of these registry keys are monitored by Microsoft Defender ATP EDR, such as ASEP techniques, which will trigger specific alerts. Plus, the registry keys in question require a minimum of Local Admin or Trusted Installer privileges to be able to be modified. Having a locked down environment, with minimum administrative accounts or rights is recommended. Last, but not least, there are other system configurations that can be enabled, like "Disable SeDebug for non-required roles" that are part of our wider security recommendations.|
|All Processes: Block creation of specific files and registry keys||Registry Modifications|*\Software\*,HKCU\Environment\UserInitMprLogonScript,HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Accessibility\ATs\*\StartExe, HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\*\Debugger,HKEY_CURRENT_USER\Software\Microsoft\HtmlHelp Author\location,HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\*\MonitorProcess|The way ASR rules work are by blocking the attack techniques, and not the Indicators of Compromise (IOC) that are not durable and effective. Blocking a specific file extension, for example, is not often helpful, since it would not prevent a device from being compromised. It will only partially thwarts an  attack, until the malicious actor creates a new type of extension for the payload.|Having Microsoft Defender AV enabled, along with Cloud Protection and Behavior Analysis is highly recommended. It is also recommended to have additional preventative layers, such as the ASR rule "Use advanced protection against ransomware", to provide a greater level of protection against ransomware attacks. Furthermore, several of these registry keys are monitored by Microsoft Defender ATP EDR, such as ASEP techniques, which will trigger specific alerts. Plus, the registry keys in question require a minimum of Local Admin or Trusted Installer privileges to be able to be modified. Having a locked down environment, with minimum administrative accounts or rights is recommended. Last, but not least, there are other system configurations that can be enabled, like "Disable SeDebug for non-required roles" that are part of our wider security recommendations.|Having Microsoft Defender AV enabled, along with Cloud Protection and Behavior Analysis is highly recommended. It is also recommended to have additional preventative layers, such as the ASR rule "Use advanced protection against ransomware", to provide a greater level of protection against ransomware attacks. Furthermore, several of these registry keys are monitored by Microsoft Defender ATP EDR, such as ASEP techniques, which will trigger specific alerts. Plus, the registry keys in question require a minimum of Local Admin or Trusted Installer privileges to be able to be modified. Having a locked down environment, with minimum administrative accounts or rights is recommended. Last, but not least, there are other system configurations that can be enabled, like "Disable SeDebug for non-required roles" that are part of our wider security recommendations.|
|Untrusted Programs from USB: Block untrusted programs from running from removable drives|*|Process Execution|*|ASR rules have a built-in rule to prevent the launch of untrusted and unsigned programs from removable drives:  "Block untrusted and unsigned processes that run from USB", GUID "b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4".|Please explore additional controls for USB devices and other removable media using Microsoft Defender ATP: https://docs.microsoft.com/windows/security/threat-protection/device-control/control-usb-devices-using-intune.|
|Mshta: Block Mshta from launching certain child processes|mshta.exe|Process Execution|powershell.exe, cmd.exe, regsvr32.exe|ASR rules don't contain any specific rule to prevent child processes from "mshta.exe". This control is within the remit of Exploit Protection or Windows Defender Application Control.|Enable Windows Defender Application Control to prevent mshta.exe from being executed altogether. If your organization requires "mshta.exe" for line of business apps,  configure a specific Windows Defender Exploit Protection rule, in order to prevent mshta.exe from launching child processes.|
|Outlook: Block Outlook from launching child processes|outlook.exe|Process Execution|powershell.exe|ASR rules have a built-in rule to prevent Office communication apps (Outlook, Skype and Teams) from launching child processes: "Block Office communication application from creating child processes", GUID "26190899-1602-49e8-8b27-eb1d0a1ce869".|We recommend enabling PowerShell constrained language mode, in order to minimize the attack surface from PowerShell.|
|Office: Block Office Apps from launching child processes and from creating executable content|winword.exe, powerpnt.exe, excel.exe|Process Execution|powershell.exe, cmd.exe, wscript.exe, mshta.exe, EQNEDT32.EXE, regsrv32.exe|ASR rules have a built-in rule to prevent Office apps from launching child processes:  "Block all Office applications from creating child processes", GUID "D4F940AB-401B-4EFC-AADC-AD5F3C50688A".|N/A|
|Office: Block Office Apps from launching child processes and from creating executable content|winword.exe, powerpnt.exe, excel.exe|File Creation|C:\Users\*\AppData\**\*.exe, C:\ProgramData\**\*.exe, C:\ProgramData\**\*.com, C:\Users\*AppData\Local\Temp\**\*.com, C:\Users\**\Downloads\**\*.exe, C:\Users\*\AppData\**\*.scf, C:\ProgramData\**\*.scf, C:\Users\Public\*.exe, C:\Users\*\Desktop\**\*.exe|N/A|
|Wscript: Block Wscript from reading certain types of files|wscript.exe|File Read|C:\Users\*\AppData\**\*.js*, C:\Users\*\Downloads\**\*.js*|Although, due to reliability and performance issues, ASR rules do not have the capability to prevent a specific process from reading a certain script file type. We do have a rule to prevent attack vectors that might originate from these scenarios. The rule name is "Block JavaScript or VBScript from launching downloaded executable content" (GUID "D3E037E1-3EB8-44C8-A917-57927947596D") and the "Block execution of potentially obfuscated scripts" (GUID " 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC")|Even though there are specific ASR rules that mitigate certain attack vectors within these scenarios, it's important to mention that AV is able by default to inspect scripts (PowerShell, Windows Script Host, JavaScript, VBScript, etc.) in real time, through the Antimalware Scan Interface (AMSI). More info is available here: https://docs.microsoft.com/windows/win32/amsi/antimalware-scan-interface-portal.|
|Adobe Acrobat: Block launch of child processes|AcroRd32.exe, Acrobat.exe|Process Execution|cmd.exe, powershell.exe, wscript.exe|ASR rules allow blocking Adobe Reader from launching child processes. The rule name is "Block Adobe Reader from creating child processes", GUID "7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c".|N/A|
|CertUtil: Block download or creation of executable content|certutil.exe|File Creation|*.exe|ASR rules do not cover these kinds of scenarios since they are part of AV’s built-in protection.|Microsoft Defender AV prevents CertUtil from creating or downloading executable content.|
|All Processes: Block processes from terminating critical System components|*|Process Termination|MsSense.exe, MsMpEng.exe, NisSrv.exe, svchost.exe*, services.exe, csrss.exe, smss.exe, wininit.exe, etc.|ASR rules do not cover these kinds of scenarios since they are part of Windows 10’s built-in security protections.|ELAM (Early Launch AntiMalware), PPL (Protection Process Light), PPL AntiMalware Light and System Guard.|
|Specific Processes: Block specific launch Process Attempt|"Name your Process"|Process Execution|tor.exe, bittorrent.exe, cmd.exe, powershell.exe, etc.|Overall, ASR rules are not designed to function as an Application Control plane.|To prevent users from launching specific processes or programs, the recommendation would be to use Windows Defender Application Control. Additionally, Microsoft Defender ATP File and Cert indicators, can be used in an Incident Response scenario (should not be seen as an application control mechanism).|
|All Processes: Block unauthorized changes to MDATP AV configurations|*|Registry Modifications|HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware, HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\Policy Manager\AllowRealTimeMonitoring, etc.|ASR rules do not cover these kinds  of scenarios since they are part of Microsoft Defender ATP's built-in protection.|Tamper Protection (opt-in, managed from Intune) prevents unauthorized changes to DisableAntiVirus, DisableAntiSpyware, DisableRealtimeMonitoring, DisableOnAccessProtection, DisableBehaviorMonitoring and DisableIOAVProtection registry keys (and more).|
|||||||


See also

- [Attack surface reduction FAQ](attack-surface-reduction-faq.md)
- [Enable attack surface reduction rules](enable-attack-surface-reduction.md)
- [Evaluate attack surface reduction rules](evaluate-attack-surface-reduction.md)
- [Compatibility of Microsoft Defender Antivirus with other antivirus/antimalware solutions](../microsoft-defender-antivirus/microsoft-defender-antivirus-compatibility.md)
