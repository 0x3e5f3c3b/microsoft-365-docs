


# Contents

[Overview 1](#overview)

[Get started: Navigate to the Hardware & Firmware page  2](#get-started-navigate-to-the-hardware-firmware-page)

[System model inventory 2](#system-model-inventory)

[Processor inventory 3](#processor-inventory)

[BIOS inventory 4](#bios-inventory)

[Hardware and Firmware on the device page 7](#hardware-and-firmware-on-the-device-page)

[Find processor and BIOS weaknesses 8](#find-processor-and-bios-weaknesses)

[Recommendations for firmware updates 10](#recommendations-for-firmware-updates)

[UEFI Secure Boot mode 10](#uefi-secure-boot-mode)

[Advanced Hunting 11](#advanced-hunting)

[Hardware and firmware inventory 11](#hardware-and-firmware-inventory)

[UEFI Secure Boot mode setting 13](#uefi-secure-boot-mode-setting)

[Export API 13](#export-api)

[Export with JSON response 13](#export-with-json-response)

[Export using files 15](#export-using-files)

# Overview

**Today, we are excited to announce a private preview for hardware and firmware assessment in Microsoft Defender Vulnerability Management.**

The hardware and firmware assessment feature provides a list of known hardware and firmware in your organization. It provides individual inventories for system models, processors, and BIOS. Each view includes details such as the name of the vendor, number of weaknesses, threats, and number of exposed devices.

This information means you can carry out a vulnerability assessment for processor and BIOS weaknesses for HP, Dell, and Lenovo. Weaknesses for other vendors are not reported.

Inventory and weaknesses data is collected on Windows, Linux, and MacOS (refer to the [list of supported platforms](https://docs.microsoft.com/en-us/microsoft-365/security/defender-vulnerability-management/tvm-supported-os)).

**Note**: processor and BIOS information is not reported on Mac devices with M1 processor.

As part of this feature, Defender Vulnerability Management will evaluate the UEFI Secure Boot mode setting (on Windows and Linux devices). For devices where the UEFI Secure Boot mode is disabled a recommendation will be created to enable it.

You can now experience the new hardware and firmware assessment feature in the [Microsoft 365 Defender portal.](https://security.microsoft.com/homepage)

# Get started: Navigate to the Hardware & Firmware page  

Access the new hardware and firmware assessment page by selecting [**Inventories &gt; Hardware**](https://security.microsoft.com/software-inventory/extensions) **& Firmware** under the Vulnerability management navigation menu in the [<u>Microsoft 365 Defender portal</u>](https://security.microsoft.com/homepage).  

## System model inventory

Select the **Laptops, desktop, and server modals** page to see a list of all system models in the organization. Weaknesses and exposed devices information is based on security advisories from HP, Dell, and Lenovo and relates to processors and BIOS only. Weaknesses for other OEM vendors are not reported.

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image1.png" style="width:6.4882in;height:3.23819in" />

At the top of the page, you can view the number of models per vendor.  

When you select a model from the list, a flyout panel will open with the model software details: 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image2.png" style="width:6.48819in;height:3.24375in" />

## Processor inventory

Select the **Processors** page to see a list of all processor in the organization. Weaknesses and exposed devices information is based on security advisories from HP, Dell, and Lenovo and relates to processors and BIOS only. Weaknesses for other OEM vendors are not reported.

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image3.png" style="width:6.49722in;height:3.25in" />

At the top of the page, you can view the number of processors per vendor.

When you select a processor from the list, a flyout panel will open with the processor software details: 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image4.png" style="width:6.49375in;height:3.24097in" />

## BIOS inventory

Select the **BIOS** page to view a list of all BIOS firmware in the organization. Weaknesses and exposed devices information is based on security advisories from HP, Dell, and Lenovo and relates to processors and BIOS only. Weaknesses for other OEM vendors are not reported.

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image5.png" style="width:6.49722in;height:3.24097in" />

At the top of the page, you can view the number of BIOS per vendor.

When you select a BIOS from the list, a flyout panel will open with the BIOS firmware details: 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image6.png" style="width:6.49375in;height:3.25in" />

Select **Open firmware page** to view more details about the BIOS.

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image7.png" style="width:6.49514in;height:3.24514in" />

The **Version distribution** tab show BIOS versions that are deployed in the organization.

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image8.png" style="width:6.4875in;height:3.2375in" />

When you select a version from the list, a flyout panel will open with more details on the version of the BIOS: 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image9.png" style="width:6.49792in;height:3.26389in" />

Select the **Missing security updates** tab to see BIOS security updates that should be installed on the device to remediate discovered BIOS vulnerabilities.

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image10.png" style="width:6.49444in;height:3.25278in" />

When you select an item from the list, a flyout panel will open with a link to the BIOS vendor advisory, a list of exposed devices, and a list of CVEs.

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image11.png" style="width:6.5in;height:3.45347in" />

# Hardware and Firmware on the device page

The device page now shows the system model, processor, and BIOS information.

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image12.png" style="width:6.48611in;height:3.24514in" alt="Graphical user interface, text, application Description automatically generated" />

When you select **See all details**, a flyout panel will open with more information: 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image13.png" style="width:6.5in;height:3.24514in" alt="Graphical user interface, application Description automatically generated" />

# Find processor and BIOS weaknesses

1.  In the Microsoft 365 Defender portal, go to **Vulnerability management** &gt; **Weaknesses.**

2.  Search for ‘BIOS’

CVEs that relate to the processor or BIOS will be returned.

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image14.png" style="width:6.49583in;height:3.2375in" />

When you select an item from the list, a flyout panel will open with more details on the CVE.

Discovered vulnerabilities for processor and BIOS CVEs will also appear on Discovered vulnerabilities tab for a device.

On selecting a CVE and flyout panel will open more information:

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image15.png" style="width:6.5in;height:3.24931in" alt="Graphical user interface, application Description automatically generated" />

# Recommendations for firmware updates

1.  In the Microsoft 365 Defender portal, go to **Vulnerability management** &gt; **Recommendations**

2.  Filter on Remediation type ‘Firmware update’

Recommendations to update a specific BIOS version if it was installed on at least 5% of devices across all organizations will appear

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image16.png" style="width:6.49167in;height:3.25in" />

# UEFI Secure Boot mode

Defender Vulnerability Management finds devices on which UEFI Secure Boot mode is disabled and recommends enabling it.

To find these recommendations search for “scid-2100” or “boot” in the recommendations page. This capability is currently supported only on Windows. Other platforms will be supported in the near future.

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image17.png" style="width:6.49792in;height:3.26389in" />

On selecting a recommendation and flyout panel will open with more information:

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image18.png" style="width:6.48819in;height:3.24514in" />

# Advanced Hunting

## Hardware and firmware inventory

A new table **DeviceTvmHardwareFirmware** was added to Advanced Hunting. This table contains hardware and firmware information per device, including system model, processor, and BIOS. See a description of the table columns below.

<table>
<thead>
<tr class="header">
<th><strong>Column Name</strong></th>
<th><strong>Type</strong></th>
<th><strong>Data example</strong></th>
<th><strong>Customer Facing Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DeviceId</td>
<td>string</td>
<td> </td>
<td>Unique identifier for the device in the service</td>
</tr>
<tr class="even">
<td>DeviceName</td>
<td>string</td>
<td> </td>
<td>Fully qualified domain name (FQDN) of the device</td>
</tr>
<tr class="odd">
<td>ComponentType</td>
<td>string</td>
<td>“Hardware”, “Processor”, “Bios”</td>
<td>Type of hardware or firmware component</td>
</tr>
<tr class="even">
<td>Manufacturer</td>
<td>string</td>
<td><p>System: “lenovo”, “dell”, “hp”.</p>
<p>Processor: “intel”, “amd”</p>
<p>BIOS: “lenovo”, “ami”, “intel”</p></td>
<td>Manufacturer of hardware or firmware component</td>
</tr>
<tr class="odd">
<td>ComponentName</td>
<td>string</td>
<td><p>System: “ThinkPad T470s (20HGS00P1C)”</p>
<p>Processor: “Intel(R) Core(TM) i7-7600U CPU @ 2.80GHz”</p>
<p>BIOS: “ThinkPad T470s (20HGS00P1C)”</p></td>
<td>Name of hardware or firmware component</td>
</tr>
<tr class="even">
<td>ComponentVersion</td>
<td>string</td>
<td><p>System: “”</p>
<p>Processor: “”</p>
<p>BIOS: “N1WET61W”</p></td>
<td>Component version (for example, BIOS version)</td>
</tr>
<tr class="odd">
<td>AdditionalFields</td>
<td>string</td>
<td><p>System:</p>
<p>{</p>
<p>     “Family”: “Lenovo ThinkPad”,</p>
<p>      “SerialNumber”: “PC0P30G9”</p>
<p> }</p>
<p> </p>
<p>Processor:</p>
<p>{ “Family”: “7th Generation Intel® Core™ Processor Family” }</p>
<p> </p>
<p>BIOS:</p>
<p>{</p>
<p>     “FirmwareReleaseDate”: “2020/10/19”</p>
<p>}</p></td>
<td><p>Additional information about the components in JSON array format</p>
<p>Key-value pairs:</p>
<p>System:</p>
<ul>
<li><p>Family - system model family</p></li>
<li><p>SerialNumber - system model serial number</p></li>
</ul>
<p>Processor:</p>
<ul>
<li><p>Family - processor family</p></li>
</ul>
<p>BIOS:</p>
<ul>
<li><p>FirmwareReleaseDate - BIOS release date</p></li>
</ul></td>
</tr>
</tbody>
</table>

Here are some sample queries to hunt for using this table:

Count the number of Lenovo devices

**DeviceTvmHardwareFirmware**

**\| where ComponentType == "Hardware" and Manufacturer == "lenovo"**

**\| summarize count()**

Find all devices with specific vulnerable BIOS version

**DeviceTvmHardwareFirmware**

**\| where ComponentType == "Bios" and ComponentVersion contains "N2VET29W"**

**\|project DeviceId, DeviceName**

## UEFI Secure Boot mode setting

To find devices that require enabling of UEFI Secure Boot mode use the following query.

**DeviceTvmSecureConfigurationAssessment**

**\| where ConfigurationId == "scid-2100"**

**\| project DeviceId, DeviceName**

# Export API

You can use APIs to view all hardware and firmware installed in your organization, including component type, vendor, and version.

## Export with JSON response

Request:

**GET https://api.security.microsoft.com/api/machines/HardwareFirmwareInventoryProductCodeByMachine**

Response body:

**{**

**    "@odata.context": "https://api-df.securitycenter.microsoft.com/api/$metadata\#Collection(microsoft.windowsDefenderATP.api.AssetHardwareFirmware)",**

**    "value": \[**

**        {**

**            "deviceId": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",**

**            "rbacGroupId": 39,**

**            "rbacGroupName": "xxxxxxxxxxxxxxx",**

**            "deviceName": "xxxxxxxxxxx",**

**            "componentType": "Hardware",**

**            "manufacturer": "razer",**

**            "componentName": "blade\_15\_advanced\_model\_(mid\_2021)\_-\_rz09-0409",**

**            "componentVersion": "7.04",**

**            "additionalFields": "{\\"SystemSKU\\":\\"RZ09-0409CE53\\",\\"BaseBoardManufacturer\\":\\"Razer\\",\\"BaseBoardProduct\\":\\"CH570\\",\\"BaseBoardVersion\\":\\"4\\",\\"DeviceFamily\\":\\"Workstation\\"}"**

**        },**

**        {**

**            "deviceId": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",**

**            "rbacGroupId": 39,**

**            "rbacGroupName": "xxxxxxxxxxxxxxx",**

**            "deviceName": "xxxxxxxxxxx",**

**            "componentType": "Bios",**

**            "manufacturer": "razer",**

**            "componentName": "blade\_15\_advanced\_model\_(mid\_2021)\_-\_rz09-0409\_firmware",**

**            "componentVersion": "1.10.0.0",**

**            "additionalFields": "{\\"BIOSReleaseDate\\":\\"2021-08-06 00:00:00\\",\\"BIOSLastDetected\\":\\"2022-07-11 03:03:27\\"}"**

**        },**

**        {**

**            "deviceId": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",**

**            "rbacGroupId": 39,**

**            "rbacGroupName": "xxxxxxxxxxxxxxx",**

**            "deviceName": "xxxxxxxxxxx",**

**            "componentType": "Processor",**

**            "manufacturer": "intel",**

**            "componentName": "11th Gen Intel(R) Core(TM) i9-11900H @ 2.50GHz",**

**            "componentVersion": null,**

**            "additionalFields": "{\\"ThreadsCount\\":16}"**

**        },**

**        {**

**            "deviceId": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",**

**            "rbacGroupId": 9,**

**            "rbacGroupName": "xxxxxxxxxxxxxxx",**

**            "deviceName": "xxxxxxxxxxxxxxx",**

**            "componentType": "Hardware",**

**            "manufacturer": "microsoft",**

**            "componentName": "surface\_laptop\_3",**

**            "componentVersion": "124I:00036T:000M:0300000D:0B:07F:1C:05P:48S:01E:0Y:1K:0U:00",**

**            "additionalFields": "{\\"SystemSKU\\":\\"Surface\_Laptop\_3\_1867:1868\\",\\"BaseBoardManufacturer\\":\\"Microsoft Corporation\\",\\"BaseBoardProduct\\":\\"Surface Laptop 3\\",\\"BaseBoardVersion\\":\\"\\",\\"DeviceFamily\\":\\"Workstation\\"}"**

**        },**

**…**

**}**

## Export using files

Request:

**GET https://api.security.microsoft.com/api/machines/HardwareFirmwareInventoryExport**

Response body:

**{**

**    "@odata.context": "https://api-df.securitycenter.microsoft.com/api/$metadata\#microsoft.windowsDefenderATP.api.ExportFilesResponse",**

**    "exportFiles": \[**

**        "https://tvmexportstrprdcane.blob.core.windows.net/tvm-firmware-export/2022-07-11/1101/FirmwareHardwareExport/json/OrgId=d7c7c745-195f-4223-9c7a-99fb420fd000/\_RbacGroupId=39/part-00999-71eea973-1bb1-4d0a-829d-80cb07aff5d8.c000.json.gz?sv=2020-08-04&st=2022-07-11T13%3A10%3A06Z&se=2022-07-11T16%3A10%3A06Z&sr=b&sp=r&sig=muN8Sq6rVN6bFMtR0u3S5Wzh3D9qNPgN5vpU7lWvULg%3D",**

**        "https://tvmexportstrprdcane.blob.core.windows.net/tvm-firmware-export/2022-07-11/1101/FirmwareHardwareExport/json/OrgId=d7c7c745-195f-4223-9c7a-99fb420fd000/\_RbacGroupId=9/part-00968-71eea973-1bb1-4d0a-829d-80cb07aff5d8.c000.json.gz?sv=2020-08-04&st=2022-07-11T13%3A10%3A06Z&se=2022-07-11T16%3A10%3A06Z&sr=b&sp=r&sig=%2BA0%2B4qOOBCS5E4UenJPbMdLM%2FkbXHnz%2F1pvfSOCq%2F2s%3D",**

**        "https://tvmexportstrprdcane.blob.core.windows.net/tvm-firmware-export/2022-07-11/1101/FirmwareHardwareExport/json/OrgId=d7c7c745-195f-4223-9c7a-99fb420fd000/\_RbacGroupId=9/part-00969-71eea973-1bb1-4d0a-829d-80cb07aff5d8.c000.json.gz?sv=2020-08-04&st=2022-07-11T13%3A10%3A06Z&se=2022-07-11T16%3A10%3A06Z&sr=b&sp=r&sig=sZUgYMwSr5zk6BZvS%2BoYIWlHJWk2oJ7YjiC8R26S1X4%3D"**

**    \],**

**    "generatedTime": "2022-07-11T11:01:00Z"**

**}**
