Network shares configuration assessment  

 

The ability to share files and folders over a network, allows users provide access to resources like files, documents, and media to other people on the network.  

As network shares can be easily accessed by network users there are some common weaknesses that can be used in the wild by attackers for lateral movement, reconnaissance, and data exfiltration. For example, sharing folders with full write permissions could allow an attacker to replace legitimate files with malware to gain lateral movement in the network or cause damage. 

When vulnerable network share configurations are identified, they are mapped to actionable security recommendations in the **Security recommendations** page. As operating system configurations don’t always directly relate to enabling or disabling a security control, the following configuration assessments can help protect against a vulnerability, caused by a network share configuration, that could be exploited by attackers: 

-   [<u>Disallow offline access to shares</u>](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsip.security.microsoft.com%2Fsecurity-recommendations%2Fsca-_-scid-4000&data=04%7C01%7CSinead.OSullivan%40microsoft.com%7C29c0db0fd3b94654d3dc08da05d2d3ce%7C72f988bf86f141af91ab2d7cd011db47%7C0%7C0%7C637828700305785398%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=iJGgALlvXTSOKdOn3nQOiXc5qo1RmgT6JwPT907Pvgo%3D&reserved=0) 

-   [<u>Remove shares from the root folder</u>](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsip.security.microsoft.com%2Fsecurity-recommendations%2Fsca-_-scid-4002&data=04%7C01%7CSinead.OSullivan%40microsoft.com%7C29c0db0fd3b94654d3dc08da05d2d3ce%7C72f988bf86f141af91ab2d7cd011db47%7C0%7C0%7C637828700305785398%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=%2F%2FuGTJKiXOCFv1ZUSK7hlD7N95drvk7lDhjg%2B5%2Bt%2F7U%3D&reserved=0) 

-   [<u>Remove share write permission set to ‘Everyone’</u>](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsip.security.microsoft.com%2Fsecurity-recommendations%2Fsca-_-scid-4001&data=04%7C01%7CSinead.OSullivan%40microsoft.com%7C29c0db0fd3b94654d3dc08da05d2d3ce%7C72f988bf86f141af91ab2d7cd011db47%7C0%7C0%7C637828700305785398%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=MZxCzKsmLE2tbPyygeWArzPJ%2B67gkEE2SuEtEdgrMes%3D&reserved=0) 

-   [<u>Set folder enumeration for shares</u>](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fsecurity.microsoft.com%2Fsecurity-recommendations%2Fsca-_-scid-4003&data=04%7C01%7CSinead.OSullivan%40microsoft.com%7C29c0db0fd3b94654d3dc08da05d2d3ce%7C72f988bf86f141af91ab2d7cd011db47%7C0%7C0%7C637828700305785398%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=YMMg%2BTQwjMXOrbe3b8KOER%2B1RKwINVWqJM6QUua6XfM%3D&reserved=0) 

 

Find information about exposed network shares  

 

To see security recommendations addressing network share configurations: 

 

1.  Go to **Vulnerability management** in the left navigation menu  

<!-- -->

1.  Select **Recommendations ** 

<!-- -->

1.  Select Filters and choose ‘Related component à OS à Shares’ 

>  
>
> <img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image1.png" style="width:2.76042in;height:2.05208in" alt="Graphical user interface, text, application Description automatically generated" /> 

1.  Select **Apply** 

>  
>
> <img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image2.png" style="width:6.26806in;height:2.30694in" alt="Graphical user interface, text, application, email Description automatically generated" /> 

 

When you select a recommendation a flyout will open with information for the network share configuration assessed: 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image3.png" style="width:6.26806in;height:4.93333in" alt="Graphical user interface, text, application, email Description automatically generated" /> 

Explore the ‘Exposed devices’ and ‘Exposed shares’ tabs for a detailed list of the exposed entities in your organization. 

You can submit a remediation request from the remediation options tab: 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image4.png" style="width:6.26806in;height:5.00694in" alt="Graphical user interface, text, application, email Description automatically generated" /> 

 
