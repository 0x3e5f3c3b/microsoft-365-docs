Digital certificate assessment  

In this private preview, you can now experience the new **Certificate inventory** available in the Microsoft 365 Defender portal. You’ll be able to view a list of the TLS/SSL certificates installed across your organization in a single central certificate inventory page. 

As part of the TLS\\SSL protocol, certificates are used to provide data encryption and authentication to ensure the secure transfer of information within your network and over the internet. If there is an issue with a certificate, for example, it has expired or is misconfigured, it could leave your organization vulnerable, cause an outage, and have an impact on day-to-day business operations.  

From today you’ll be able to easily discover and manage these certificates, in the new certificate inventory in vulnerability management. This can help you:  

-   Identify certificates that are about to expire so you can update them and prevent service disruption 

-   Detect potential vulnerabilities ​due to the use of weak algorithms (SHA-1)​ 

<!-- -->

-   Ensure compliance with regulatory guidelines and organizational policy ​ 

Get started: Navigate to the Certificate inventory page 

Access the certificate inventory page by selecting **Certificate inventory** under the Vulnerability management navigation menu in the [<u>Microsoft 365 Defender portal</u>](https://security.microsoft.com/homepage). 

Certificate inventory overview 

The **Certificate inventory** page opens with a list of the certificates installed across your organization, including details on the expiration date, key size, who issued the certificate, and the number of instances. 

**Note:** Only certificates found on Windows devices (in the local machine certificate store) will be displayed in certificate inventory list. 

 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image1.png" style="width:6.26806in;height:1.88542in" alt="Graphical user interface, application, email Description automatically generated" /> 

 

Gain insights into potentially vulnerable certificates 

At the top of the page, view the number of certificates that have been identified as potentially less secure and introduce risk into your organization: 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image2.png" style="width:6.26806in;height:0.58333in" /> 

This includes the number of certificates that:  

-   have already expired 

-   will expire in 60 days or less 

<!-- -->

-   have a key size with fewer than 2048 bits, as they are considered less secure 

-   have a weak signature algorithm, like SHA-1 and MD5 

-   are considered vulnerable since they are self-signed  

 

Use filters on the certificate inventory page 

 

You can use filters to view the inventory based on: 

 

-   **Certificate status:** view the certificates that have expired, are expiring soon, issued with future date, or current  

-   **Self-signed:** view certificates that are self-signed  

<!-- -->

-   **Key size:** view certificates that have a short key size or valid key size 

-   **Signature hash:** view certificates that have a weak signature hash or valid signature hash  

-   **Key usage:** view certificates with key usage values, such as digital signature, repudiation, and certificate signing 

Get more information on a discovered certificate 

When you select the certificate that you want to investigate, a flyout panel will open with the certificate details page: 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image3.png" style="width:3.83333in;height:5.07292in" alt="Graphical user interface, text, application Description automatically generated" /> 

You can select the **issuing details** tab to see information on who the certificate was issued to and who it was issued by.  

To see the list of the devices the certificate is installed on, choose the **Installed devices** tab:  

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image4.png" style="width:3.96875in;height:2.54167in" alt="Table Description automatically generated" /> 

From here, you can search for a particular device the certificate is installed on, and you can export a list of the devices to excel.  

Certificate inventory on devices 

You can also view a list of certificates installed on a device. To do this: 

1.  Go to the **Device inventory** page and select the device 

<!-- -->

1.  Select the **Certificate inventory** tab to see a list of certificates installed on that device 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image5.png" style="width:6.26806in;height:1.65625in" alt="Graphical user interface, text, application, email Description automatically generated" /> 

 

Select a certificate to open the flyout with more information, including information on the certificate path: 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image6.png" style="width:6.26806in;height:2.69028in" alt="Graphical user interface, text, application, email Description automatically generated" /> 

 

New threat and vulnerability management dashboard widget 

See how many certificates have expired or are due to expire in the next 30, 60 or 90 days from a new **Expiring certificates** widget available in the threat and vulnerability management dashboard.  

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image7.png" style="width:4.01042in;height:3.20833in" alt="Timeline Description automatically generated" /> 

Select **View all** to go to the certificate inventory page. 

 

Certificates information in advanced hunting 

   
You can now also use an advanced hunting query to view a list of certificates installed in your organization. For example, using the DeviceTvmCertificateInfo table, you can query to show all expired certificates: 

<img src="C:\GitHub\microsoft-365-docs-pr\microsoft-365\security\defender-vulnerability-management\media\image8.png" style="width:2.88542in;height:0.86458in" alt="Graphical user interface, text, application Description automatically generated" /> 

 

 

Certificate assessment API  

This private preview release provides support for the following certificate assessment APIs: 

Export certificate assessment per device 

Different API calls get different types of data. Because the amount of data can be large, there are two ways it can be retrieved: 

<u>Export certificate assessment </u>**JSON response**: The API pulls all data in your organization as Json responses. This method is best for *small organizations with less than 100K devices*. The response is paginated, so you can use the @odata.nextLink field from the response to fetch the next results. 

<u>Export certificate assessment </u>**via files**: This API solution can pull large amounts of data faster and more reliably. This API is recommended for *large organizations with more than 100K devices*. It will pull all the data in your organization as download files, including URLs to download all the data from Azure Storage. You can download data from Azure Storage two ways: 

-   Call the API to get a list of download URLs with all your organization data. 

-   Download all the files using the download URLs and process the data as you like. 

Data that is collected (using either *Json response* or *via files*) is the current snapshot of the current state. It doesn't contain historic data. To collect historic data, customers must save and store the data themselves. 

Export certificate assessment (JSON response) 

This API returns all certificate assessments for all devices, on a per-device basis. It returns a table with a separate entry for every unique combination of DeviceId, Thumbprint and Path. 

URL: GET /api/machines/certificateAssessmentByMachine 

Export certificate assessment (via files) 

This API returns all certificate assessments for all devices, on a per-device basis. It returns a table with a separate entry for every unique combination of DeviceId, Thumbprint and Path. 

URL: GET /api/machines/certificateAssessmentExport 

To learn more about this API including its parameters, properties, HTTP request header and example request and response values, see [<u>Appendi</u>](bookmark://_Appendix_D)
