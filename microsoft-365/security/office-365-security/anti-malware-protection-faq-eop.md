---
title: "Anti-malware protection FAQ "
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: 013c8a5f-8990-40e4-bfa8-f92ff1042623
ms.collection:
- M365-security-compliance
description: "This section provides frequently asked questions and answers about antimalware protection. Answers are applicable for Exchange Online and Exchange Online Protection customers."
---

# Anti-malware protection FAQ

This topic provides frequently asked questions and answers about anti-malware protection for customers with mailboxes in Exchange Online or standalone Exchange Online Protection (EOP) customers without Exchange Online mailboxes.

## Q. What are best practice recommendations for configuring and using the service to combat malware?

A. See [EOP anti-malware policy settings](recommended-settings-for-eop-and-office365-atp.md#eop-anti-malware-policy-settings).

## Q. How often are the malware definitions updated?

A. Each server checks for new malware definitions from our anti-malware partners every hour.

## Q. How many anti-malware partners do you have? Can I choose which malware engines we use?

A. We have partnerships with multiple best-of-breed providers of anti-malware technologies. The number of partners we have is subject to change, but all of our customers are automatically protected by multiple anti-malware partners at all times. There is no way to choose one engine over another.

## Q. Where does malware scanning occur?

A. We scan for malware in messages that are sent to or sent from a mailbox (messages in transit). For Exchange Online mailboxes, we also have [malware zero-hour auto purge (ZAP)](zero-hour-auto-purge.md) to scan for malware in messages that have already been delivered. If you re-send a message from a mailbox, then it's scanned again (because it's in transit).

## Q. If I make a change to an anti-malware policy, how long does it take after I save my changes for them to take effect?

A. It might take up to 1 hour for the changes to take effect.

## Q. Does the service scan internal messages for malware?

A. For Exchange Online customers, the service scans inbound and outbound messages for malware, and messages sent between internal recipients. In most cases, a standalone Exchange Online Protection subscription scans messages as they enter or leave your existing on-premises email organization, and does not scan messages sent between internal users. However, you can use the built-in antimalware features of Exchange Server to scan internal messages for malware. For more information, see [Antimalware protection in Exchange Server](https://docs.microsoft.com/Exchange/antispam-and-antimalware/antimalware-protection/antimalware-protection).

## Q. Do all anti-malware engines used by the service have heuristic scanning enabled?

Yes. This enables the anti-malware engines to scan for both known (signature match) and unknown (suspicious) malware.

## Q. Can the service scan compressed files (such as .zip files)?

Yes. The anti-malware engines can drill into compressed (archive) files.

## Q. Is the compressed attachment scanning support recursive (.zip within a .zip within a .zip) and if so, how deep does it go?

Yes, recursive scanning of compressed files scans many layers deep.

## Q. Does the service work with legacy Exchange versions and non-Exchange environments?

A. Yes, the service is server agnostic.

## Q. What's a zero-day virus and how is it handled by the service?

A. A zero-day virus is a first generation, previously unknown variant of malware that's never been captured or analyzed, so our anti-malware engines don't yet have any definitions available for detecting it. After a zero-day virus sample is captured and analyzed by our anti-malware engines, a definition is created to detect it based on the unique signature of the malware, and it's no longer considered "zero-day."

## Q. How can I configure the service to block specific executable files (such as \*.exe) that I fear may contain malware?

A. You can enable the **Common Attachment Types Filter** (also known as common attachment blocking) as described in [Anti-malware policies](anti-malware-protection.md#anti-malware-policies).

You can also create an Exchange mail flow rule (also known as transport rule) that blocks any email attachment that has executable content. Follow the steps in [How to reduce malware threats through file attachment blocking in Exchange Online Protection](https://support.microsoft.com/kb/2959596) in order to block the file types listed in [Supported file types for mail flow rule content inspection in Exchange Online](https://docs.microsoft.com/exchange/security-and-compliance/mail-flow-rules/inspect-message-attachments#supported-file-types-for-mail-flow-rule-content-inspection).

For increased protection, we also recommend using the **Any attachment file extension includes these words** condition in mail flow rules to block some or all of the following extensions: ade, adp, ani, bas, bat, chm, cmd, com, cpl, crt, hlp, ht, hta, inf, ins, isp, job, js, jse, lnk, mda, mdb, mde, mdz, msc, msi, msp, mst, pcd, reg, scr, sct, shs, url, vb, vbe, vbs, wsc, wsf, wsh.

## Q. Why did a specific malware get past the filters?

A. There are two possible reasons why you might have received malware:

1. Most likely, the attachment does not actually contain malicious code. Some anti-malware engines that run on computers might be more aggressive and could stop messages with truncated payloads.

2. The malware you received is a new variant and our anti-malware partners have not yet released a pattern file for the service to deploy. The time it takes for an update to be released is dependent on the anti-malware partners.

## Q. How can I submit malware that made it past the filters to Microsoft? Also, how can I submit a file that I believe was incorrectly detected as malware?

A. See [Submitting malware and non-malware to Microsoft for analysis](submitting-malware-and-non-malware-to-microsoft-for-analysis.md).

## Q. I received an email message with an unfamiliar attachment. Is this malware or can I disregard this attachment?

A. We strongly advise that you do not open any attachments that you do not recognize. If you would like us to investigate the attachment, go to the Malware Protection Center and submit the possible malware to us as described previously.

## Q. Where can I get the messages that have been deleted by the malware filters?

A. The messages contain active malicious code and therefore we do not allow access to these messages. They are simply deleted.

## Q. I am not able to receive a specific attachment because it is being falsely filtered by the malware filters. Can I allow this attachment through via mail flow rules?

A. No. You can't use Exchange mail flow rules to skip malware filtering. To skip malware filtering, send the attachment in a password protected .zip file (malware filtering skips password protected files).

## Q. Can I get reporting data about malware detections?

A. Yes, you can access reports in the admin center. For more information about reporting, see the following links:

Exchange Online customers: [Monitoring, Reporting, and Message Tracing in Exchange Online](https://docs.microsoft.com/exchange/monitoring/monitoring)

Exchange Online Protection customers: [Reporting and message trace in Exchange Online Protection](reporting-and-message-trace-in-exchange-online-protection.md)

## Q. Is there a tool that I can use to follow a malware-detected message through the service?

A. Yes, the message trace tool enables you to follow email messages as they pass through the service. For more information about how to use the message trace tool to find out why a message was detected to contain malware, see [Message trace in the Security & Compliance Center](message-trace-scc.md).

## Q. Can I use a third-party anti-spam and anti-malware provider in conjunction with Exchange Online?

A. Yes. In most cases, we recommend that you point your MX records to (that is, deliver email directly to) EOP. If you need to route your email somewhere else first, you need to enable [Enhanced Filtering for Connectors](https://docs.microsoft.com/exchange/mail-flow-best-practices/use-connectors-to-configure-mail-flow/enhanced-filtering-for-connectors) so EOP can use the true message source in filtering decisions.

## Q. Are spam and malware messages being investigated as to who sent them, or being transferred to law enforcement entities?

A. The service focuses on spam and malware detection and removal, though we may occasionally investigate especially dangerous or damaging spam or attack campaigns and pursue the perpetrators. This may involve working with our legal and digital crime units to take down a spammer botnet, blocking the spammer from using the service (if they're using it for sending outbound email), and passing the information on to law enforcement for criminal prosecution.

## For more information

[Configure anti-malware policies](configure-anti-malware-policies.md)

[Anti-malware protection](anti-malware-protection.md)
