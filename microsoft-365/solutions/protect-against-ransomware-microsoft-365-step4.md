---
title: "Step 4. Protect devices"
author: JoeDavies-MSFT
f1.keywords:
- NOCSH
ms.author: josephd
manager: dansimp
audience: ITPro
ms.topic: article
ms.prod: microsoft-365-enterprise
ms.localizationpriority: high
ms.collection:
- M365-security-compliance
- Strat_O365_Enterprise
- ransomware
- m365solution-ransomware
ms.custom: seo-marvel-jun2020
keywords: 
description: Step through protecting your Microsoft 365 resources from ransomware attacks.
---

# Step 4. Protect devices

- Turn on Microsoft Defender Antivirus. (Execution)
- Turn on Microsoft Defender Firewall. (Lateral movement)
- Use advanced protection against ransomware. (Impact)
- Enable Network Protection in Microsoft Defender for Endpoint and Microsoft 365 Defender. (Initial access)
- Keep cloud-delivered protection in Microsoft Defender Antivirus turned on. (Defense evasion)
- Keep Microsoft Defender Antivirus real-time behavior monitoring turned on. (Defense evasion)
- Turn on real-time protection. (Defense evasion)
- Turn on tamper protection in Microsoft Defender for Endpoint, to prevent malicious changes to security settings. (Defense evasion)
- Update Microsoft Defender Antivirus definitions. (Lateral movement)
- Configure site and download checking in Microsoft Defender SmartScreen to block or warn. (Initial access)
- Configure app and file checking in Microsoft Defender SmartScreen to block or warn. (Initial access)
- Enable Microsoft Defender Antivirus scanning of downloaded files and attachments. (Initial access)
- Block Win32 API calls from Office macros. (Execution)
- Migrate all legacy workbooks requiring Excel 4.0 macros to the updated VBA macro format using this process. (Execution)
- Disable use of unsigned macros. Ensure all internal macros with business need are signed and leveraging trusted locations to ensure unknown macros will not run in your environment. (Execution)
- Stop malicious XLM or VBA macros by ensuring runtime macro scanning by Antimalware Scan Interface (AMSI) is on. This feature—enabled by default—is on if the Group Policy setting for Macro Run Time Scan Scope is set to Enable for All Files or Enable for Low Trust Files. Get the latest group policy template files. (Execution)
- Set Remote Desktop security level to TLS in Microsoft Defender for Endpoint and Microsoft 365 Defender. (Initial access)


